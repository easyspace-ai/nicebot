# 10-Minute Timeout Feature

## Overview

The bot now includes automatic order cancellation and position selling after 10 minutes.

## How It Works

### 1. Order Placement
- Bot places 2 orders (1 on Yes, 1 on No) at $0.49, 10 shares each
- Total: $9.80 USDC required
- Orders are placed 5 minutes before market starts

### 2. Monitoring (0-10 minutes)
- Bot checks order status every 60 seconds
- Logs any fills or partial fills
- Dashboard shows real-time order status

### 3. 10-Minute Timeout (After 10 minutes)
When 10 minutes have elapsed since order placement:

**Step 1: Cancel Unfilled Orders**
- Bot identifies any orders still PLACED or PARTIALLY_FILLED
- Cancels all unfilled orders
- Logs: "Cancelled X orders"

**Step 2: Sell Filled Positions**
- Bot checks which orders were filled (fully or partially)
- For each filled order:
  - Gets the exact filled size from CLOB API
  - Places a SELL order at current best bid price
  - This ensures quick execution (market sell)
- Logs: "Selling X shares of [outcome] at $Y.YY"

**Step 3: Mark as Complete**
- Bot marks this market as processed
- Won't attempt to sell again for this market
- Keeps orders visible in dashboard for reference

## Example Flow

```
Time 0:00 - Orders placed
  - BUY Yes @ $0.49 x 10 shares
  - BUY No @ $0.49 x 10 shares

Time 0:05 - Yes order fills
  - Status: Yes = FILLED, No = PLACED

Time 10:00 - Timeout triggered
  1. Cancel No order (unfilled)
  2. Sell Yes position:
     - Get current best bid for Yes (e.g., $0.51)
     - Place SELL Yes @ $0.51 x 10 shares
     - Quick fill at market price
  3. Mark market as complete

Result:
  - Bought Yes at $0.49
  - Sold Yes at $0.51
  - Profit: $0.02 per share = $0.20 total
  - No order cancelled with no loss
```

## Configuration

The timeout is hardcoded to **10 minutes (600 seconds)** in [bot.py:212](bot.py#L212):

```python
if time_since_placement >= 600:  # 10 minutes
```

To change the timeout, edit this value:
- 300 = 5 minutes
- 600 = 10 minutes (current)
- 900 = 15 minutes

## Files Modified

1. **[bot.py](bot.py)**
   - Added `positions_sold` tracking dict
   - Added timeout check in `_check_active_orders()`
   - Added `_sell_positions()` method

2. **[order_manager.py](order_manager.py)**
   - Added `sell_position_market()` method
   - Sells at current best bid for quick fill

## Benefits

1. **Risk Management**
   - Limits exposure time to market movements
   - Ensures positions don't stay open indefinitely

2. **Capital Efficiency**
   - Frees up capital after 10 minutes
   - Allows bot to place new orders on other markets

3. **Profit Taking**
   - Automatically realizes gains from filled orders
   - Sells at current market price (best bid)

4. **Loss Minimization**
   - Cancels unfilled orders quickly
   - No wasted capital on orders unlikely to fill

## Dashboard Visibility

The dashboard will show:
- Order placement time
- Time elapsed since placement
- Order status (PLACED, FILLED, CANCELLED)
- Sell orders generated by timeout (marked as SELL)

## Notes

- Timeout only applies to orders from `place_simple_test_orders()`
- Each market is processed only once (no duplicate sells)
- Sell orders placed at best bid for quick execution
- All actions are logged to `bot.log`

## Safety

- Bot won't sell the same position twice (tracked in `positions_sold` dict)
- Only sells positions that were actually filled
- Uses exact filled size from CLOB API
- Rate limits between sell orders (0.5 second delay)
